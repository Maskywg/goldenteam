<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perplexity + Gemini 黃金工作流 (HITL版)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Marked for Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        body { margin: 0; overflow-x: hidden; background-color: #0f172a; }
        .animate-fade-in-down { animation: fadeInDown 1s ease-out; }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .markdown-body ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
        .markdown-body ol { list-style-type: decimal; padding-left: 1.5em; margin-bottom: 1em; }
        .markdown-body h1, .markdown-body h2, .markdown-body h3 { margin-top: 1em; margin-bottom: 0.5em; font-weight: bold; }
        .markdown-body p { margin-bottom: 1em; }
        .markdown-body strong { color: #a5b4fc; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const DEFAULT_API_KEY = ""; 

        // --- Helper Function for Clipboard Copy ---
        // Fix for "NotAllowedError: Failed to execute 'writeText' on 'Clipboard'"
        const copyToClipboard = (text, onSuccess) => {
            // Create a temporary textarea element
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Ensure it's not visible but part of the DOM
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            textArea.style.top = "0";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                // Execute the deprecated but widely supported copy command
                const successful = document.execCommand('copy');
                if (successful && onSuccess) {
                    onSuccess();
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }

            document.body.removeChild(textArea);
        };

        // --- Icon Components (SVG Definitions) ---
        const IconBase = ({ children, className }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" height="24" viewBox="0 0 24 24" 
                fill="none" stroke="currentColor" strokeWidth="2" 
                strokeLinecap="round" strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Icons = {
            Search: (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>,
            Globe: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></IconBase>,
            FileUp: (props) => <IconBase {...props}><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M12 12v6"/><path d="m15 15-3-3-3 3"/></IconBase>,
            ChefHat: (props) => <IconBase {...props}><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"/><line x1="6" x2="18" y1="17" y2="17"/></IconBase>,
            GitFork: (props) => <IconBase {...props}><circle cx="12" cy="18" r="3"/><circle cx="6" cy="6" r="3"/><circle cx="18" cy="6" r="3"/><path d="M18 9v1a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V9"/><line x1="12" x2="12" y1="12" y2="15"/></IconBase>,
            Zap: (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>,
            Layers: (props) => <IconBase {...props}><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></IconBase>,
            PenTool: (props) => <IconBase {...props}><path d="m12 19 7-7 3 3-7 7-3-3z"/><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="m2 2 7.586 7.586"/><circle cx="11" cy="11" r="2"/></IconBase>,
            ArrowRight: (props) => <IconBase {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconBase>,
            ArrowLeftRight: (props) => <IconBase {...props}><path d="M8 3 4 7l4 4"/><path d="M4 7h16"/><path d="m16 21 4-4-4-4"/><path d="M20 17H4"/></IconBase>,
            Share2: (props) => <IconBase {...props}><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></IconBase>,
            CheckCircle2: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></IconBase>,
            ExternalLink: (props) => <IconBase {...props}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></IconBase>,
            BookOpen: (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>,
            Sparkles: (props) => <IconBase {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/></IconBase>,
            FileText: (props) => <IconBase {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></IconBase>,
            Bot: (props) => <IconBase {...props}><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></IconBase>,
            X: (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>,
            UserCog: (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><circle cx="19" cy="11" r="2"/><path d="M19 8v1"/><path d="M19 13v1"/><path d="M16 11h1"/><path d="M21 11h1"/></IconBase>,
            Play: (props) => <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3"/></IconBase>,
            Compass: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></IconBase>,
            Copy: (props) => <IconBase {...props}><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></IconBase>,
            Wand2: (props) => <IconBase {...props}><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z"/><path d="m14 7 3 3"/><path d="M5 6v4"/><path d="M19 14v4"/><path d="M10 2v2"/><path d="M7 8H3"/><path d="M21 16h-4"/><path d="M11 3H9"/></IconBase>
        };

        const DigitalRain = () => {
            const canvasRef = useRef(null);
            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                const resize = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
                resize();
                const symbols = '01';
                const fontSize = 14;
                const columns = canvas.width / fontSize;
                const drops = [];
                for (let i = 0; i < columns; i++) drops[i] = 1;
                const draw = () => {
                    ctx.fillStyle = 'rgba(15, 23, 42, 0.1)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = '#0f0'; ctx.font = `${fontSize}px monospace`;
                    for (let i = 0; i < drops.length; i++) {
                        const text = symbols.charAt(Math.floor(Math.random() * symbols.length));
                        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                        drops[i]++;
                    }
                };
                const interval = setInterval(draw, 33);
                window.addEventListener('resize', resize);
                return () => { clearInterval(interval); window.removeEventListener('resize', resize); };
            }, []);
            return <canvas ref={canvasRef} className="fixed inset-0 z-0 pointer-events-none opacity-30" />;
        };

        const ChefModal = ({ isOpen, onClose }) => {
            const [topic, setTopic] = useState('');
            const [result, setResult] = useState('');
            const [loading, setLoading] = useState(false);
            const [userApiKey, setUserApiKey] = useState('');
            const [error, setError] = useState('');

            if (!isOpen) return null;

            const handleAnalyze = async () => {
                if (!topic) return;
                setLoading(true); setError(''); setResult('');
                const keyToUse = userApiKey || DEFAULT_API_KEY;
                if (!keyToUse) { setError('請輸入 Gemini API Key 以進行模擬。'); setLoading(false); return; }
                const prompt = `扮演一位專業的產業分析師（Role: AI Chef）。請針對主題「${topic}」進行深度結構分析。請產出一個簡報大綱，格式要求：1. 使用 Markdown 格式。2. 包含三個主要章節。3. 每個章節列出 3 個關鍵數據或論點 (Bullet points)。4. 語氣專業、精簡，直接列出重點，不要有開場白。`;
                try {
                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${keyToUse}`,
                        { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }) }
                    );
                    const data = await response.json();
                    if (data.error) throw new Error(data.error.message || 'API Error');
                    const generatedText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                    setResult(generatedText || '無法生成內容，請稍後再試。');
                } catch (err) { console.error(err); setError('生成失敗：' + err.message + ' (請檢查 API Key 是否正確)'); } finally { setLoading(false); }
            };

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-black/80 backdrop-blur-sm" onClick={onClose}></div>
                    <div className="relative bg-slate-800 border border-purple-500/50 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl animate-fade-in-down flex flex-col">
                        <div className="p-6 border-b border-white/10 flex justify-between items-center bg-slate-900/50">
                            <div className="flex items-center gap-3">
                                <div className="p-2 bg-purple-500/20 rounded-lg"><Icons.ChefHat className="w-6 h-6 text-purple-400" /></div>
                                <div><h2 className="text-xl font-bold text-white">AI 廚師模擬器</h2><p className="text-xs text-purple-300">Powered by Gemini 2.5 Flash</p></div>
                            </div>
                            <button onClick={onClose} className="text-slate-400 hover:text-white transition-colors"><Icons.X className="w-6 h-6" /></button>
                        </div>
                        <div className="p-6 space-y-4 flex-grow">
                            <div className="space-y-2"><label className="text-sm text-slate-300 font-medium">1. 輸入研究主題 (Ingredients)</label><input type="text" value={topic} onChange={(e) => setTopic(e.target.value)} placeholder="例如：2025 AI 醫療趨勢、台積電庫存分析..." className="w-full bg-slate-900 border border-slate-600 rounded-lg p-3 text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors" /></div>
                            {!DEFAULT_API_KEY && (<div className="space-y-2"><label className="text-sm text-slate-300 font-medium">2. Gemini API Key (Required)</label><input type="password" value={userApiKey} onChange={(e) => setUserApiKey(e.target.value)} placeholder="Paste your Gemini API Key here" className="w-full bg-slate-900 border border-slate-600 rounded-lg p-3 text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors" /><p className="text-xs text-slate-500">此 Key 僅用於本次模擬，不會被儲存。</p></div>)}
                            <button onClick={handleAnalyze} disabled={loading || !topic} className={`w-full py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-all ${loading || !topic ? 'bg-slate-700 text-slate-500 cursor-not-allowed' : 'bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white shadow-lg hover:shadow-purple-500/25'}`}>{loading ? <><Icons.Sparkles className="w-5 h-5 animate-spin" />廚師料理中...</> : <><Icons.Bot className="w-5 h-5" />開始結構分析</>}</button>
                            {error && <div className="p-3 bg-red-900/30 border border-red-500/50 rounded-lg text-red-200 text-sm">{error}</div>}
                            {result && <div className="mt-6 space-y-2 animate-fade-in-down"><label className="text-sm text-slate-300 font-medium">3. 廚師分析報告 (Output)</label><div className="bg-slate-900/80 border border-purple-500/30 rounded-xl p-4 text-slate-200 text-sm leading-relaxed max-h-60 overflow-y-auto markdown-body" dangerouslySetInnerHTML={{ __html: marked.parse(result) }}></div></div>}
                        </div>
                    </div>
                </div>
            );
        };

        const PromptGeneratorModal = ({ isOpen, onClose }) => {
            const [inputs, setInputs] = useState({
                subject: '',
                source: '',
                style: '',
                content: '',
                audience: ''
            });
            const [copied, setCopied] = useState(false);

            useEffect(() => {
                if (isOpen) setCopied(false);
            }, [isOpen]);

            const generatedPrompt = useMemo(() => {
                const { subject, source, style, content, audience } = inputs;
                if (!subject && !source && !style && !content && !audience) return "請填寫左側欄位以產生 Prompt...";
                
                return `角色設定：你是一位專業的簡報設計師與溝通專家。

【簡報基本資訊】
• 簡報主題（主角）：${subject || '[請輸入主題]'}
• 目標對象：${audience || '[請輸入對象]'}
• 資料來源：${source || '[請輸入來源]'}
• 設計風格：${style || '[請輸入風格]'}

【內容要求】
請根據上述設定，並涵蓋以下重點內容：
${content || '[請輸入詳細內容]'}

【任務指令】
請根據以上資訊，為我生成一份詳細的簡報架構（Slide Deck Outline）。
請包含：
1. 每張投影片的標題 (Slide Title)
2. 關鍵論點 (Key Bullet Points)
3. 建議的配圖或視覺元素 (Visual Suggestions)
4. 針對該頁的演講備忘錄 (Speaker Notes)

請使用 Markdown 格式輸出。`;
            }, [inputs]);

            const handleChange = (field, value) => {
                setInputs(prev => ({ ...prev, [field]: value }));
            };

            const handleCopy = () => {
                copyToClipboard(generatedPrompt, () => {
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                });
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-black/80 backdrop-blur-sm" onClick={onClose}></div>
                    <div className="relative bg-slate-800 border border-rose-500/50 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-2xl animate-fade-in-down flex flex-col md:flex-row">
                        {/* Header for Mobile */}
                        <div className="md:hidden p-4 border-b border-white/10 flex justify-between items-center bg-slate-900/50">
                            <h2 className="text-lg font-bold text-white flex items-center gap-2"><Icons.Wand2 className="w-5 h-5 text-rose-400" />Prompt 生成器</h2>
                            <button onClick={onClose}><Icons.X className="w-6 h-6 text-slate-400" /></button>
                        </div>

                        {/* Input Section */}
                        <div className="w-full md:w-1/2 p-6 space-y-4 border-b md:border-b-0 md:border-r border-white/10 overflow-y-auto">
                             <div className="hidden md:flex items-center gap-3 mb-6">
                                <div className="p-2 bg-rose-500/20 rounded-lg"><Icons.Wand2 className="w-6 h-6 text-rose-400" /></div>
                                <div><h2 className="text-xl font-bold text-white">簡報指令生成器</h2><p className="text-xs text-rose-300">Prompt Configuration</p></div>
                            </div>

                            <div className="space-y-3">
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">簡報主角 / 主題</label>
                                    <input type="text" value={inputs.subject} onChange={e => handleChange('subject', e.target.value)} placeholder="例如：2025 Q3 財務報告、新產品發表..." className="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-sm text-white focus:border-rose-500 focus:outline-none transition-colors" />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">簡報對象</label>
                                    <input type="text" value={inputs.audience} onChange={e => handleChange('audience', e.target.value)} placeholder="例如：公司高層、潛在投資人、大學生..." className="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-sm text-white focus:border-rose-500 focus:outline-none transition-colors" />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">簡報來源</label>
                                    <input type="text" value={inputs.source} onChange={e => handleChange('source', e.target.value)} placeholder="例如：上傳的 PDF、市場調查數據、NotebookLM 筆記..." className="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-sm text-white focus:border-rose-500 focus:outline-none transition-colors" />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">簡報風格</label>
                                    <input type="text" value={inputs.style} onChange={e => handleChange('style', e.target.value)} placeholder="例如：專業嚴謹、活潑互動、Steve Jobs 極簡風..." className="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-sm text-white focus:border-rose-500 focus:outline-none transition-colors" />
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-1 block">簡報重點內容</label>
                                    <textarea value={inputs.content} onChange={e => handleChange('content', e.target.value)} rows="4" placeholder="請列出必須包含的關鍵數據、結論或章節..." className="w-full bg-slate-900 border border-slate-700 rounded-lg p-2.5 text-sm text-white focus:border-rose-500 focus:outline-none transition-colors resize-none"></textarea>
                                </div>
                            </div>
                        </div>

                        {/* Output Section */}
                        <div className="w-full md:w-1/2 p-6 bg-slate-900/50 flex flex-col relative">
                            <button onClick={onClose} className="hidden md:block absolute top-4 right-4 text-slate-400 hover:text-white transition-colors"><Icons.X className="w-6 h-6" /></button>
                            
                            <h3 className="text-sm font-bold text-slate-300 mb-4 flex items-center gap-2"><Icons.Sparkles className="w-4 h-4 text-yellow-400" />Generated Prompt Preview</h3>
                            
                            <div className="flex-grow bg-slate-950 border border-slate-800 rounded-xl p-4 text-slate-300 font-mono text-sm leading-relaxed overflow-y-auto whitespace-pre-wrap shadow-inner relative group">
                                {generatedPrompt}
                            </div>

                            <button 
                                onClick={handleCopy}
                                className={`mt-4 w-full py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-all shadow-lg ${copied ? 'bg-green-600 text-white' : 'bg-gradient-to-r from-rose-600 to-pink-600 hover:from-rose-500 hover:to-pink-500 text-white'}`}
                            >
                                {copied ? <><Icons.CheckCircle2 className="w-5 h-5" />已複製到剪貼簿</> : <><Icons.Copy className="w-5 h-5" />複製 Prompt</>}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const WorkflowApp = () => {
            const [activeStep, setActiveStep] = useState(null);
            const [isChefModalOpen, setIsChefModalOpen] = useState(false);
            const [isPromptModalOpen, setIsPromptModalOpen] = useState(false);

            const steps = [
                {
                    id: 1,
                    title: "獵人階段：雙模組搜集",
                    description: "啟動獵人模式，根據需求選擇搜集引擎。既可利用 Perplexity 進行廣度掃描，也可運用 Gemini Deep Research 進行深度挖掘。",
                    icon: <Icons.Search className="w-6 h-6" />,
                    tool: "Perplexity & Gemini",
                    color: "bg-teal-900/60 text-teal-200 border-teal-500",
                    badge: "Hunter Mode",
                    hitl: "關鍵決策：篩選權威來源",
                    paths: [
                        { 
                            name: "獵人 1：Perplexity 廣度獵捕", 
                            desc: "輸入問題追問權威來源，過濾雜訊，導出 PDF。", 
                            icon: <Icons.Globe className="w-4 h-4 text-teal-400" />,
                            url: "https://www.perplexity.ai/",
                            urlText: "前往 Perplexity"
                        },
                        { 
                            name: "獵人 2：Gemini 深度研究", 
                            desc: "運用 Deep Research 進行專題挖掘，獲取深層洞察。", 
                            icon: <Icons.Sparkles className="w-4 h-4 text-purple-400" />,
                            url: "https://gemini.google.com/",
                            urlText: "前往 Gemini"
                        },
                        {
                            name: "策略參考：探勘優化指南",
                            desc: "依照資料樣態，決定最佳探勘流程與工具選擇。",
                            icon: <Icons.Compass className="w-4 h-4 text-teal-400" />,
                            url: "https://drive.google.com/file/d/1eWgBFccUjcwQbFUGIW1g64QJMLHtxBGm/view?usp=sharing",
                            urlText: "查看流程圖"
                        }
                    ]
                },
                {
                    id: 2,
                    title: "廚師階段：資料餵食與深度料理",
                    description: "將 Perplexity 與 Gemini 蒐集的資料上傳至 NotebookLM。利用其 RAG 技術建立無幻覺知識庫，執行從數據比對到觀點提煉的一站式料理。",
                    icon: <Icons.ChefHat className="w-6 h-6" />,
                    tool: "NotebookLM",
                    url: "https://notebooklm.google.com/",
                    demoUrl: "https://docs.google.com/presentation/d/1bwFOl3G_BSvatDErgaYkfDvrMWca22KlMdwHf7dSe0E/edit?usp=sharing",
                    color: "bg-purple-900/60 text-purple-200 border-purple-500",
                    badge: "Chef Mode",
                    hitl: "關鍵動作：上傳並驗證資料",
                    paths: [
                        { 
                            name: "細項 1：交叉比對", 
                            desc: "比對不同來源的數據，識別矛盾點與資訊落差，確保引用權威與準確。", 
                            icon: <Icons.ArrowLeftRight className="w-4 h-4 text-purple-400" />,
                            prompt: "你是總編輯。請嚴格比對這兩份報告，禁用外部知識：1. 列出雙方確認的共同事實。2. 用表格呈現雙方矛盾的數據或觀點。3. 整合雙方互補的獨有資訊。請據此產出附帶來源引用的最終定稿，確保資訊精確無誤。"
                        },
                        { 
                            name: "細項 2：分析與結論", 
                            desc: "整合驗證後的資訊，提煉關鍵洞察 (Insights)，生成具備邏輯的簡報大綱。", 
                            icon: <Icons.FileText className="w-4 h-4 text-purple-400" />,
                            prompt: "請你完全且嚴格地根據我上傳的這些 PDF 檔案來輸出摘要與簡報大綱，並回答我的問題。你不準使用任何你腦袋裡本來的知識。如果答案在文件裡找不到，你就直接說找不到。而且你講的每一個論點，都必須給我標出是來自哪個檔案的第幾頁。"
                        }
                    ]
                },
                {
                    id: 3,
                    title: "簡報生成：雙軌分流",
                    description: "取得大綱後，根據工具特性選擇以下兩條路徑，最終皆匯出為 PPTx 格式：",
                    icon: <Icons.GitFork className="w-6 h-6" />,
                    tool: "Dual Strategy",
                    color: "bg-gradient-to-r from-pink-900/60 to-rose-900/60 text-rose-200 border-rose-500",
                    badge: "簡報生成",
                    hitl: "關鍵決策：選擇生成策略",
                    promptGenerator: "開啟簡報 Prompt 生成器",
                    paths: [
                        { name: "途徑 1：Gemini 3.0 Canvas 流", desc: "Gemini 3.0 ➔ Canvas 生成簡報 ➔ 匯出 PPTx", icon: <Icons.Zap className="w-4 h-4 text-yellow-400" /> },
                        { 
                            name: "途徑 2：NotebookLM 轉檔流", 
                            desc: "NotebookLM 生成 PDF ➔ Canva/PPT 轉檔 ➔ 匯出 PPTx", 
                            icon: <Icons.Layers className="w-4 h-4 text-blue-400" />,
                            url: "https://www.canva.com/templates",
                            urlText: "前往 Canva Templates"
                        }
                    ]
                },
                {
                    id: 4,
                    title: "Google Slides 整合與精修",
                    description: "雙軌匯流點。將 PPTx 匯入後，進行重新編輯、美化與重新製圖。在此階段呼叫 Nano Banana Pro 進行專業級修飾。",
                    icon: <Icons.PenTool className="w-6 h-6" />,
                    tool: "Nano Banana Pro",
                    url: "https://slides.google.com/",
                    editUrl: "https://kevinchaiimagetowordv2.netlify.app/",
                    videoUrl: "https://www.youtube.com/watch?v=R_CwAva8bks",
                    videoText: "拿回文字主導",
                    color: "bg-yellow-900/60 text-yellow-200 border-yellow-500",
                    badge: "美化重製",
                    hitl: "關鍵動作：美感審核與修飾"
                },
                {
                    id: 5,
                    title: "簡報輸出與分享",
                    description: "完成的簡報可匯出為 PDF/PPTX 或生成連結直接在線共享，完美展示經過多重 AI 優化後的成果。",
                    icon: <Icons.Share2 className="w-6 h-6" />,
                    tool: "Google Slides",
                    url: "https://slides.google.com/",
                    editUrl: "https://kevinchaiimagetowordv2.netlify.app/",
                    videoUrl: "https://www.youtube.com/watch?v=R_CwAva8bks",
                    videoText: "拿回文字主導",
                    color: "bg-yellow-900/60 text-yellow-200 border-yellow-500",
                    badge: "成果發布"
                }
            ];

            return (
                <div className="min-h-screen font-sans text-slate-200 p-4 md:p-8 relative overflow-hidden">
                    <DigitalRain />
                    <ChefModal isOpen={isChefModalOpen} onClose={() => setIsChefModalOpen(false)} />
                    <PromptGeneratorModal isOpen={isPromptModalOpen} onClose={() => setIsPromptModalOpen(false)} />
                    <div className="relative z-10">
                        <header className="max-w-4xl mx-auto text-center mb-12 animate-fade-in-down">
                            <div className="inline-flex items-center justify-center p-2 bg-slate-800/80 rounded-full shadow-sm mb-4 border border-slate-700 backdrop-blur-sm">
                                <span className="bg-gradient-to-r from-teal-500 to-purple-600 text-white text-xs font-bold px-3 py-1 rounded-full mr-2">Power User Workflow</span>
                                <span className="text-slate-300 text-sm font-medium">Hunter & Chef & Artist</span>
                            </div>
                            <h1 className="text-3xl md:text-5xl font-extrabold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-teal-400 via-blue-500 to-purple-500">
                                Perplexity + Gemini 黃金組合
                            </h1>
                            <p className="text-lg text-slate-400 max-w-2xl mx-auto leading-relaxed mb-8">
                                從獵人搜集、廚師料理，到 <span className="font-bold text-rose-400">雙軌生成與 Nano 精修</span>，打造最完整的 AI 工作流。
                            </p>
                            
                            {/* 更新：三按鈕區域 (新增探勘優化策略) */}
                            <div className="flex flex-wrap justify-center gap-4">
                                {/* 核心價值按鈕 */}
                                <a 
                                    href="https://docs.google.com/presentation/d/1r0Afy3b3ImLM9LClqiyCSVk__A8OLIY--2m1R4nuKkw/edit?usp=sharing" 
                                    target="_blank" 
                                    rel="noopener noreferrer" 
                                    className="group relative inline-flex items-center gap-3 px-8 py-3 bg-slate-900/50 hover:bg-slate-800 border border-slate-700 hover:border-blue-500/50 rounded-full transition-all duration-300 hover:shadow-[0_0_20px_rgba(59,130,246,0.2)] hover:-translate-y-1"
                                >
                                    <span className="absolute inset-0 rounded-full bg-gradient-to-r from-blue-500/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-opacity"></span>
                                    <Icons.BookOpen className="w-5 h-5 text-blue-400 group-hover:scale-110 transition-transform duration-300" />
                                    <span className="text-base font-bold text-slate-200 group-hover:text-white tracking-wide">核心價值</span>
                                    <Icons.ExternalLink className="w-4 h-4 text-slate-500 group-hover:text-blue-300 transition-colors" />
                                </a>

                                {/* 簡略摘要按鈕 */}
                                <a 
                                    href="https://docs.google.com/presentation/d/1iUQO9gjdNzI2bfK7KaXndfORJzAFL0N10hw9Jedokkk/edit?usp=sharing" 
                                    target="_blank" 
                                    rel="noopener noreferrer" 
                                    className="group relative inline-flex items-center gap-3 px-8 py-3 bg-slate-900/50 hover:bg-slate-800 border border-slate-700 hover:border-purple-500/50 rounded-full transition-all duration-300 hover:shadow-[0_0_20px_rgba(168,85,247,0.2)] hover:-translate-y-1"
                                >
                                    <span className="absolute inset-0 rounded-full bg-gradient-to-r from-purple-500/10 to-pink-500/10 opacity-0 group-hover:opacity-100 transition-opacity"></span>
                                    <Icons.Layers className="w-5 h-5 text-purple-400 group-hover:scale-110 transition-transform duration-300" />
                                    <span className="text-base font-bold text-slate-200 group-hover:text-white tracking-wide">簡略摘要</span>
                                    <Icons.ExternalLink className="w-4 h-4 text-slate-500 group-hover:text-purple-300 transition-colors" />
                                </a>

                                {/* 新增：探勘優化策略按鈕 */}
                                <a 
                                    href="https://drive.google.com/file/d/1eWgBFccUjcwQbFUGIW1g64QJMLHtxBGm/view?usp=sharing" 
                                    target="_blank" 
                                    rel="noopener noreferrer" 
                                    title="依照資料樣態優化探勘流程"
                                    className="group relative inline-flex items-center gap-3 px-8 py-3 bg-slate-900/50 hover:bg-slate-800 border border-slate-700 hover:border-teal-500/50 rounded-full transition-all duration-300 hover:shadow-[0_0_20px_rgba(20,184,166,0.2)] hover:-translate-y-1"
                                >
                                    <span className="absolute inset-0 rounded-full bg-gradient-to-r from-teal-500/10 to-emerald-500/10 opacity-0 group-hover:opacity-100 transition-opacity"></span>
                                    <Icons.Compass className="w-5 h-5 text-teal-400 group-hover:scale-110 transition-transform duration-300" />
                                    <span className="text-base font-bold text-slate-200 group-hover:text-white tracking-wide">探勘優化策略</span>
                                    <Icons.ExternalLink className="w-4 h-4 text-slate-500 group-hover:text-teal-300 transition-colors" />
                                </a>
                            </div>
                        </header>
                        <main className="max-w-3xl mx-auto relative">
                            <div className="absolute left-8 md:left-1/2 top-4 bottom-4 w-1 bg-slate-700 transform -translate-x-1/2 hidden md:block z-0"></div>
                            <div className="absolute left-6 top-4 bottom-4 w-1 bg-slate-700 md:hidden z-0"></div>
                            <div className="space-y-8 relative z-10">
                                {steps.map((step, index) => {
                                    const isEven = index % 2 === 0;
                                    const isActive = activeStep === step.id;
                                    return (
                                        <div key={step.id} className={`flex flex-col md:flex-row items-center group ${isEven ? 'md:flex-row-reverse' : ''}`} onMouseEnter={() => setActiveStep(step.id)} onMouseLeave={() => setActiveStep(null)}>
                                            <div className={`w-full md:w-5/12 pl-12 md:pl-0 ${isEven ? 'md:pl-8' : 'md:pr-8'}`}>
                                                <div className={`relative p-6 rounded-2xl shadow-md border-l-4 transition-all duration-300 transform cursor-default backdrop-blur-md flex flex-col ${step.color} ${isActive ? 'scale-105 shadow-xl -translate-y-1 bg-opacity-80' : 'hover:shadow-lg bg-opacity-60'}`}>
                                                    <div className="flex justify-between items-start mb-3">
                                                        <span className="inline-block px-2 py-1 bg-slate-800/60 rounded text-xs font-bold tracking-wider backdrop-blur-sm">{step.badge}</span>
                                                        <span className="text-xs font-semibold opacity-70">Step 0{step.id}</span>
                                                    </div>
                                                    <h3 className="text-xl font-bold mb-2 text-slate-100 flex items-center gap-2">{step.title}</h3>
                                                    <p className="text-sm text-slate-300 leading-relaxed mb-4">{step.description}</p>
                                                    
                                                    {step.hitl && (
                                                        <a 
                                                            href="https://drive.google.com/file/d/1tC1h_UEX6khcFRtdjcqdM2BA_0Czt5lr/view?usp=sharing" 
                                                            target="_blank" 
                                                            rel="noopener noreferrer" 
                                                            onClick={(e) => e.stopPropagation()}
                                                            className="mb-4 inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/10 border border-amber-500/30 text-amber-200 text-xs font-bold animate-pulse hover:bg-amber-500/20 transition-colors cursor-pointer"
                                                        >
                                                            <Icons.UserCog className="w-4 h-4" />
                                                            <span>{step.hitl}</span>
                                                            <span className="ml-1 px-1 bg-amber-500/20 rounded text-[10px]">HITL</span>
                                                            <Icons.ExternalLink className="w-3 h-3 ml-1 opacity-70" />
                                                        </a>
                                                    )}

                                                    {step.paths && (
                                                        <div className="space-y-3 mt-2 mb-4">
                                                            {step.paths.map((path, pIdx) => (
                                                                <div key={pIdx} className="bg-slate-800/50 p-3 rounded-lg border border-white/10 hover:bg-slate-800/80 transition-colors">
                                                                    <div className="flex items-center gap-2 mb-1">
                                                                        {path.icon}
                                                                        <span className="font-bold text-sm text-white">{path.name}</span>
                                                                    </div>
                                                                    <div className="pl-6">
                                                                        <div className="text-xs text-slate-400">{path.desc}</div>
                                                                        
                                                                        {/* PROMPT 區塊 */}
                                                                        {path.prompt && (
                                                                            <div className="mt-2 bg-slate-900/50 p-2 rounded border border-white/5 relative group/prompt">
                                                                                <div className="text-[10px] text-slate-500 font-bold uppercase mb-1">建議 Prompt</div>
                                                                                <div className="text-xs text-purple-300 font-mono break-words pr-6">{path.prompt}</div>
                                                                                <button 
                                                                                    onClick={(e) => { 
                                                                                        e.stopPropagation(); 
                                                                                        copyToClipboard(path.prompt, () => {
                                                                                            // alert('已複製 Prompt!'); // Optional feedback
                                                                                        });
                                                                                    }}
                                                                                    className="absolute top-2 right-2 text-slate-500 hover:text-white transition-colors p-1 rounded hover:bg-slate-700"
                                                                                    title="複製 Prompt"
                                                                                >
                                                                                    <Icons.Copy className="w-3 h-3" />
                                                                                </button>
                                                                            </div>
                                                                        )}

                                                                        {path.url && (
                                                                            <a href={path.url} target="_blank" rel="noopener noreferrer" className="inline-flex items-center mt-2 px-2 py-1 rounded bg-blue-500/10 hover:bg-blue-500/20 text-[10px] text-blue-300 hover:text-blue-200 transition-colors" onClick={(e) => e.stopPropagation()}>
                                                                                {path.urlText} <Icons.ExternalLink className="ml-1 w-3 h-3" />
                                                                            </a>
                                                                        )}
                                                                    </div>
                                                                </div>
                                                            ))}
                                                            <div className="flex justify-center -mb-2 opacity-50"><Icons.ArrowRight className="w-4 h-4 text-slate-400 rotate-90" /></div>
                                                        </div>
                                                    )}

                                                    {/* 新增的 Prompt 生成器按鈕 */}
                                                    {step.promptGenerator && (
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); setIsPromptModalOpen(true); }}
                                                            className="w-full mt-2 mb-4 py-2 rounded-lg bg-gradient-to-r from-pink-600/80 to-rose-600/80 hover:from-pink-500 hover:to-rose-500 text-white font-bold text-sm shadow-lg border border-white/10 flex items-center justify-center gap-2 transition-all hover:shadow-rose-500/20"
                                                        >
                                                            <Icons.Wand2 className="w-4 h-4" />
                                                            {step.promptGenerator}
                                                        </button>
                                                    )}

                                                    <div className="mt-auto pt-2 flex flex-wrap justify-end gap-2">
                                                        {step.demoUrl && (
                                                            <a href={step.demoUrl} target="_blank" rel="noopener noreferrer" className="inline-flex items-center px-3 py-2 rounded-lg bg-emerald-500/20 hover:bg-emerald-500/30 border border-emerald-500/40 text-xs font-bold uppercase tracking-wider transition-all duration-200 hover:scale-105 active:scale-95 text-emerald-200" onClick={(e) => e.stopPropagation()}>查看說明<Icons.BookOpen className="ml-2 w-3 h-3" /></a>
                                                        )}
                                                        {step.editUrl && (
                                                            <a href={step.editUrl} target="_blank" rel="noopener noreferrer" className="inline-flex items-center px-3 py-2 rounded-lg bg-amber-500/20 hover:bg-amber-500/30 border border-amber-500/40 text-xs font-bold uppercase tracking-wider transition-all duration-200 hover:scale-105 active:scale-95 text-amber-200" onClick={(e) => e.stopPropagation()}>文字修改<Icons.PenTool className="ml-2 w-3 h-3" /></a>
                                                        )}
                                                        {step.url && (
                                                            <a href={step.url} target="_blank" rel="noopener noreferrer" className="inline-flex items-center px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 border border-white/20 text-xs font-bold uppercase tracking-wider transition-all duration-200 hover:scale-105 active:scale-95" onClick={(e) => e.stopPropagation()}>Open Tool<Icons.ExternalLink className="ml-2 w-3 h-3" /></a>
                                                        )}
                                                        {step.videoUrl && (
                                                            <a href={step.videoUrl} target="_blank" rel="noopener noreferrer" className="inline-flex items-center px-3 py-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 border border-red-500/40 text-xs font-bold uppercase tracking-wider transition-all duration-200 hover:scale-105 active:scale-95 text-red-200" onClick={(e) => e.stopPropagation()}>
                                                                {step.videoText}<Icons.Play className="ml-2 w-3 h-3" />
                                                            </a>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="absolute left-6 md:left-1/2 transform -translate-x-1/2 flex flex-col items-center justify-center">
                                                <div className={`w-12 h-12 rounded-full border-4 border-slate-800 shadow-lg flex items-center justify-center transition-all duration-500 ${isActive ? 'bg-slate-700 text-white scale-110' : 'bg-slate-900 text-slate-400'}`}>{step.icon}</div>
                                            </div>
                                            <div className="hidden md:block w-5/12"></div>
                                        </div>
                                    );
                                })}
                            </div>
                            <div className="flex justify-center mt-12 relative z-10">
                                <div className="flex flex-col items-center">
                                    <div className="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center text-white shadow-xl animate-bounce"><Icons.CheckCircle2 size={32} /></div>
                                    <span className="mt-3 font-bold text-green-400 bg-slate-800/80 px-4 py-1 rounded-full backdrop-blur-sm">黃金流程完成</span>
                                </div>
                            </div>
                        </main>
                        <section className="max-w-6xl mx-auto mt-20 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <BenefitCard title="雙模組獵人 (搜集)" subtitle="Perplexity & Gemini" features={["獵人1：Perplexity 廣搜", "獵人2：Gemini 深研", "全方位素材獲取"]} color="bg-teal-900/40 border-teal-700 text-teal-300" />
                            <BenefitCard title="NotebookLM (廚師)" subtitle="深度料理" features={["建立無幻覺知識庫", "交叉比對分析", "產出結構大綱"]} color="bg-purple-900/40 border-purple-700 text-purple-300" />
                            <BenefitCard title="雙軌生成 (戰術)" subtitle="殊途同歸" features={["Gemini 3.0 Canvas 流", "NotebookLM 轉檔流", "皆匯出為 PPTx"]} color="bg-rose-900/40 border-rose-700 text-rose-300" />
                            <BenefitCard title="Nano Banana Pro (美化)" subtitle="完美成果" features={["Google Slides 整合", "重新製圖", "專業級修飾"]} color="bg-yellow-900/40 border-yellow-700 text-yellow-300" />
                        </section>
                        <footer className="mt-16 text-center text-slate-500 text-sm pb-8">
                            <p>© 2025 Power User Workflow Visualization</p>
                            <p className="mt-2 font-medium text-slate-400">製作人: Masky Wang</p>
                        </footer>
                    </div>
                </div>
            );
        };
        const BenefitCard = ({ title, subtitle, features, color }) => (
            <div className={`p-6 rounded-xl border ${color} hover:shadow-md transition-shadow backdrop-blur-sm bg-opacity-40`}>
                <h4 className="text-lg font-bold mb-1 text-slate-200">{title}</h4>
                <p className="text-sm opacity-80 mb-4 uppercase tracking-wide font-semibold">{subtitle}</p>
                <ul className="space-y-2">
                    {features.map((item, idx) => (
                        <li key={idx} className="flex items-center text-sm"><div className="w-1.5 h-1.5 rounded-full bg-current mr-2 opacity-60"></div>{item}</li>
                    ))}
                </ul>
            </div>
        );
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WorkflowApp />);
    </script>
</body>
</html>
